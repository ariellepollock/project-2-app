<%- include('../partials/header') %>

    <% if (watchlist) { %>
        <h2 class="LHeader"><%= watchlist.title %></h2>

        <!-- List movies in the watchlist -->
        <% if (watchlist.movies && watchlist.movies.length > 0) { %>
            <ul class="wList">
                <% watchlist.movies.forEach(movie => { %>
                    <div class="card-body d-flex align-items-center justify-content-center mb-3">
                        <input type="checkbox" class="me-2 movie-checkbox align-self-center" id="movie-<%= movie.id %>">
                        <a href="/movies/<%= movie.movieId %>" class="card-list">
                            <h4 class="card-title wList"><%= movie.title %></h4>
                        </a>
                    </div>
                <% }) %>
            </ul><br>
        <% } else { %>
            <p class="addMovies mb-4">Start adding movies.</p>
        <% } %>

        <% if (signedIn && username && userId && watchlist.owner.equals(userId)) { %>
            <!-- Update Form -->
            <form method="POST" action="/watchlists/update/<%= watchlist._id %>" class="mx-5">
                <div class="d-flex align-items-center g-2">
                    <div class="flex-grow-1 me-2">
                        <input type="text" class="form-control" id="name" name="name" placeholder="New Watchlist Name" required>
                    </div>
                    <button type="submit" class="btn btn-color">Update Name</button>
                </div>
            </form>
            
            <!-- Delete Button -->
            <form method="POST" action="/watchlists/delete/<%= watchlist._id %>">
                <button type="submit" class="btn btn-danger wDelete">Delete Watchlist</button>
            </form>
        <% } %>

    <% } else { %>
        <p>Watchlist not found, so sorry.</p>
    <% } %>

<%- include('../partials/footer') %>